from django.core.management.base import BaseCommand
from commons.models import T_apre, T_DocumentFolderAprendiz


def actualizar_carpeta(aprendiz):
    # Crear la carpeta padre si no existe
    carpeta_padre, _ = T_DocumentFolderAprendiz.objects.get_or_create(
        name="2. PLANEACION SEGUIMIENTO Y EVALUACION ETAPA PRODUCTIVA",
        tipo="carpeta",
        aprendiz=aprendiz,
        parent=None
    )

    nuevas_carpetas = {
        "EVIDENCIAS PROYECTO PRODUCTIVO": {},
        "GFPI-F-023-PLANEACIÓN, SEGUIMIENTO Y EVALUACIÓN ETAPA PRODUCTIVA": {},
        "GFPI-F-147-BITÁCORAS SEGUIMIENTO ETAPA PRODUCTIVA": {},
        "GFPI-F-165-V3-INSCRIPCIÓN A ETAPA PRODUCTIVA": {},
        "PROCESO DE CERTIFICACIÓN": {}
    }

    for sub_nombre in nuevas_carpetas:
        T_DocumentFolderAprendiz.objects.get_or_create(
            name=sub_nombre,
            tipo="carpeta",
            aprendiz=aprendiz,
            parent=carpeta_padre
        )


class Command(BaseCommand):
    help = "Actualiza la carpeta 2. del portafolio aprendiz. Puede ser por FICHAS o por id_aprendiz específico."

    def add_arguments(self, parser):
        parser.add_argument(
            "--id_aprendiz",
            type=int,
            help="ID del aprendiz específico a actualizar"
        )

    def handle(self, *args, **options):
        id_aprendiz = options.get("id_aprendiz")

        if id_aprendiz:
            try:
                aprendiz = T_apre.objects.get(id=id_aprendiz)
                actualizar_carpeta(aprendiz)
                self.stdout.write(self.style.SUCCESS(
                    f"[{aprendiz.id}] actualizado correctamente (individual)"
                ))
            except T_apre.DoesNotExist:
                self.stdout.write(self.style.ERROR(
                    f"No existe aprendiz con id {id_aprendiz}"
                ))
        else:
            aprendices = T_apre.objects.filter(ficha__num__in=FICHAS)
            for a in aprendices:
                if not a.ficha or not a.ficha.num:
                    self.stdout.write(
                        f"el aprendiz {a.id} no tiene ficha asociada")
                    continue
                actualizar_carpeta(a)
                self.stdout.write(self.style.SUCCESS(
                    f"[{a.id}] actualizado correctamente"
                ))


FICHAS = {3018230,
          3063704,
          3032252,
          3032208,
          3034030,
          3068220,
          3032278,
          3032301,
          3032333,
          3068233,
          3032236,
          3069103,
          3024914,
          3024807,
          3036816,
          3033216,
          3032568,
          3033179,
          3036817,
          2924929,
          3038052,
          3034256,
          3002707,
          3001897,
          3005640,
          3005636,
          3002528,
          3068214,
          3068217,
          3068219,
          3006543,
          3006555,
          3005469,
          3005470,
          3006151,
          3005244,
          3040711,
          2932504,
          3011155,
          3030187,
          3047197,
          3047182,
          3040773,
          3009268,
          3011154,
          3010899,
          3010861,
          3010077,
          3010097,
          3011151,
          3011164,
          3010930,
          3011181,
          3010797,
          3011097,
          3011108,
          3047145,
          3010895,
          3010917,
          3011175,
          3030190,
          3030191,
          3032139,
          3019773,
          3019785,
          3019772,
          2941076,
          3009855,
          3081786,
          3081813,
          3029011,
          3029177,
          3029014,
          2926869,
          3024473,
          3024475,
          3024478,
          3024481,
          3024483,
          3024495,
          2951235,
          2947592,
          3024703,
          3035071,
          3028995,
          2926879,
          3035089,
          2941828,
          2941832,
          2951667,
          2951756,
          2926873,
          3029163,
          3029197,
          3029053,
          3029193,
          3029078,
          3093337,
          3093340,
          3093332,
          3093348,
          3093345,
          2926840,
          3024092,
          3028722,
          3028737,
          3029109,
          3027789,
          2974200,
          2974186,
          3007865,
          3007856,
          3007401,
          3007404,
          3007657,
          3007399,
          3007654,
          3007870,
          3007833,
          3007858,
          3007859,
          3007857,
          3009669,
          3009668,
          3007866,
          3007871,
          3007872,
          3007834,
          3007855,
          3135466,
          3135472,
          3007407,
          3007409,
          3007411,
          3007424,
          3007426,
          3007428,
          3007431,
          3007432,
          3007433,
          2991742,
          3023792,
          3023725,
          2904012,
          2904013,
          3025253,
          3025290,
          3025286,
          2980763,
          2904205,
          2904206,
          2904322,
          2904321,
          3008217,
          3027059,
          3006969,
          3019992,
          3027087,
          2982974,
          2982983,
          3039214,
          3039190,
          3039216,
          3039409,
          3039411,
          3027390,
          3027454,
          3027532,
          3011937,
          3009594,
          3009597,
          3005046,
          3005108,
          3005125,
          3005140,
          3007040,
          3004827,
          3011602,
          3009539,
          3009546,
          3009553,
          2940967,
          2941168,
          2941362,
          3029469,
          2952000,
          2951983,
          2951997,
          2943165,
          2941548,
          3007083,
          3012499,
          3023471,
          2951995,
          2982525,
          2982916,
          2982903,
          3025619,
          3067743,
          3025628,
          3001467,
          3016022,
          3016024,
          2982523,
          2982509,
          2981692,
          2982491,
          2982521,
          2982634,
          2982508,
          2981760,
          2981761,
          2992833,
          2992834,
          2992855,
          3010341,
          3010320,
          2988377,
          3002732,
          3027389,
          2992673,
          3010309,
          2982513,
          3010316,
          3011544,
          2982514,
          3002220,
          3002221,
          3004533,
          3004538,
          3010342,
          3010318,
          2997341,
          2997342,
          2992640,
          2992326,
          2982630,
          3002295,
          3002296,
          3010292,
          3002289,
          3027428,
          3002293,
          3018748,
          3018751,
          3000575,
          3000579,
          3000595,
          3001102,
          3018745,
          3001100,
          3001101,
          2973260,
          2973265,
          2973269,
          2973271,
          3009169,
          3018229,
          3018228,
          2981440,
          2981461,
          2981479,
          2931137,
          3022332,
          3022331,
          3022336,
          3022300,
          3022318,
          3022299,
          3022283,
          3022301,
          3022315,
          3022294,
          3022297,
          3022316,
          2993023,
          3033772,
          2996704,
          3001082,
          3001103,
          3008958,
          3008915,
          3010686,
          3015576,
          3009211,
          3015578,
          3031985,
          3069177,
          3037316,
          3008971,
          3009381,
          3036249,
          3036252,
          3009240,
          3009326,
          3009072,
          3009081,
          3029523,
          3029525,
          3029526,
          3069546,
          2979109,
          3004036,
          3004038,
          2979113,
          2979050,
          2979137,
          2979114,
          2982471,
          2982486,
          3020633,
          3020637,
          3020638,
          2989215,
          2989217,
          2989204,
          3005538,
          3005560,
          3005570,
          3005540,
          3009140,
          3009161,
          3005583,
          3005584,
          3005603,
          3009144,
          3005616,
          3005536,
          3005523,
          3005535,
          3004804,
          3036260,
          3009138,
          3009139,
          3009130,
          3008758,
          3007139,
          3007141,
          3007142,
          3011216,
          3011217,
          3011218,
          3007180,
          3006184,
          3006183,
          3005575,
          3005610,
          3005605,
          3005573,
          3005590,
          3005593,
          3005596,
          3004812,
          3004814,
          3004820,
          3004815,
          3005606,
          3005612,
          3005607,
          3005608,
          3036253,
          3027021,
          3027022,
          3027024,
          3027023,
          3012068,
          3027020,
          3024427,
          3018861,
          3018862,
          3034337,
          3004030,
          3004031,
          3024416,
          3027040,
          3012082,
          3012083,
          3016094,
          3016091,
          3016093,
          3027001,
          3016074,
          3018874,
          3018869,
          3018872,
          3012057,
          3012058,
          3012067,
          3024448,
          3024423,
          3024445,
          3003057,
          3003058,
          3016028,
          3016030,
          3016034,
          3004413,
          3004415,
          3004416,
          3012069,
          3004005,
          3004007,
          3012084,
          3021826,
          3021827,
          3027019,
          3027015,
          3027016,
          3027018,
          3011105,
          3011125,
          3011107,
          3011130,
          3068677,
          3068678,
          3011119,
          3011148,
          3011149,
          3011113,
          3011114,
          3028729,
          3011132,
          3011127,
          2985150,
          2985209,
          2985269,
          2989531,
          2989546,
          2989547,
          2989518,
          2989516,
          2989522,
          3006711,
          2989548,
          2989535,
          2989521,
          2989500,
          2989503,
          2989498,
          3025292,
          3006747,
          2989497,
          3013600,
          3006732,
          3006748,
          2989508,
          2989515,
          2954043,
          3013598,
          3013597,
          3015495,
          3015497,
          3097265,
          3097270,
          3013586,
          2954073,
          3106298,
          2954022,
          2954042,
          3039786,
          3059211,
          3013580,
          3013581,
          3006733,
          3006676,
          3026816,
          3027264,
          3027322,
          3006682,
          3006714,
          3006710,
          2989496,
          2988860,
          3097269,
          2954047,
          3013612,
          3006663,
          3006664,
          3006705,
          3006707,
          3006726,
          3006729,
          3006740,
          2989527,
          3026747,
          3086060,
          3087380,
          2989482,
          2989506,
          3004752,
          3004758,
          2990939,
          3020865,
          3013613,
          3006754,
          3008807,
          3011221,
          3009396,
          3008805,
          3013482,
          3008791,
          3009403,
          3009392,
          3036841,
          3036819,
          3049915,
          3062896,
          2990168,
          3018153,
          3018149,
          3031738,
          3016465,
          3016467,
          3016463,
          3005720,
          3005724,
          3005736,
          3005722,
          3005738,
          3005739,
          3007462,
          3006504,
          3006505,
          3007237,
          3005171,
          3005178,
          3005179,
          3005735,
          3005740,
          3005723,
          3006500,
          3006501,
          3006502,
          3010495,
          3010490,
          3010453,
          3087218,
          3016437,
          3016441,
          3016443,
          3109249,
          3007463,
          3010683,
          3010696,
          3010697,
          3010699,
          3010702,
          3010704,
          3024020,
          3025331,
          3025422,
          3025367,
          3025358,
          3025327,
          3025686,
          3025536,
          3025621,
          3025605,
          3025440,
          3025522,
          3027101,
          3027104,
          3027103,
          3026885,
          3026872,
          3026873,
          3027100,
          3047640,
          3047574,
          2988969,
          2989044,
          3007521,
          3007450,
          3007474,
          3029589,
          3029600,
          2989730,
          2989743,
          2989744,
          2989729,
          2989722,
          3007707,
          2988885,
          2980826,
          2980814,
          2980813,
          2919084,
          2918935,
          2924859,
          2988965,
          2988964,
          2922781,
          2922596,
          2917113,
          2917115,
          2904477,
          2904458,
          2904467,
          2905998,
          2906017,
          2906069,
          2906034,
          3005681,
          3005661,
          2982923,
          2982936,
          2982939,
          2982972,
          2982973,
          2982970,
          2982941,
          2982965,
          2982969,
          2924548,
          2987558,
          2987563,
          3024718,
          3022693,
          3036275,
          3000068,
          3001193,
          3003475,
          3002440,
          2924909,
          2939889,
          3010204,
          3010220,
          3026397,
          3026436,
          3007862,
          3007863,
          2991731,
          3030239,
          3007419,
          3007421,
          3007423,
          2904333,
          2980724,
          3009619,
          3012102,
          3008462,
          3010432,
          2983006,
          3039415,
          3113036,
          3007077,
          2941391,
          2941612,
          3012127,
          3012163,
          2982516,
          2982512,
          2997281,
          2982473,
          2981778,
          2982489,
          2987058,
          2987060,
          2982515,
          2982494,
          2988373,
          3002298,
          3010330,
          3010344,
          2982518,
          2982659,
          2982632,
          3010311,
          3010314,
          3002283,
          2982492,
          2982633,
          2982629,
          3010308,
          3026772,
          3027367,
          3027299,
          3022969,
          3064732,
          3027332,
          3027440,
          2992327,
          2992329,
          2992331,
          3010332,
          3010333,
          3029612,
          3016027,
          3027398,
          3027363,
          3067742,
          3025626,
          3004708,
          3002240,
          3002287,
          3002290,
          3002237,
          3002241,
          3002297,
          3025693,
          3004602,
          2982532,
          2931127,
          3001106,
          3001111,
          3001109,
          3019115,
          3019116,
          2973266,
          3013004,
          3018550,
          3018956,
          3018989,
          3018226,
          2902464,
          3009331,
          2913876,
          3018742,
          3001107,
          3033768,
          3037266,
          3009298,
          3008890,
          3009270,
          3009728,
          3009031,
          3028512,
          3069202,
          3069209,
          3037706,
          3037708,
          3037716,
          3008875,
          3009156,
          3020553,
          2988332,
          2982474,
          2996030,
          2996212,
          2982488,
          2982490,
          3020636,
          3006200,
          3006199,
          3005579,
          3005595,
          3005576,
          3005525,
          3005614,
          3005543,
          3005532,
          3005533,
          3009071,
          3008759,
          3009115,
          3006203,
          3005599,
          3011219,
          3006260,
          3005561,
          3004798,
          3004800,
          3007679,
          3004801,
          3004803,
          3006186,
          3006189,
          3007177,
          3007179,
          3006198,
          3006196,
          3006197,
          3007189,
          3007183,
          3010942,
          3015499,
          3005625,
          3005613,
          3004824,
          3004808,
          3004809,
          3007163,
          3013274,
          3004819,
          3004823,
          3004821,
          3004810,
          3006603,
          3006608,
          3004818,
          3004822,
          3004817,
          3007167,
          3006607,
          3027035,
          3027037,
          3027036,
          3018867,
          3004340,
          3027038,
          3004337,
          3004339,
          3016076,
          3027003,
          3027002,
          3027004,
          3011110,
          3011146,
          3011147,
          3004650,
          3011103,
          3004409,
          3027039,
          3011104,
          3024457,
          3028730,
          3011136,
          3011140,
          3011135,
          3012428,
          3012427,
          3012429,
          3011137,
          3011117,
          3011118,
          3011138,
          3011139,
          3011150,
          3004653,
          3004654,
          3011106,
          3011129,
          3011133,
          3011120,
          3027058,
          3011142,
          3011144,
          3011145,
          3011101,
          3011122,
          3011134,
          3011102,
          3011123,
          3028733,
          3028732,
          3028731,
          3011116,
          3011115,
          3028735,
          3011141,
          3011128,
          3011109,
          3034466,
          3068679,
          3039765,
          3039748,
          3090062,
          3005424,
          3034326,
          3005428,
          3006684,
          2989524,
          2989480,
          2989539,
          2989529,
          3006692,
          2989517,
          2989545,
          2989532,
          2989541,
          2989538,
          2989533,
          3006757,
          2989513,
          3017619,
          3017617,
          3017608,
          3013593,
          3013605,
          3015494,
          3097273,
          3097259,
          3013682,
          3106044,
          3013602,
          3013603,
          3013604,
          3006721,
          3013579,
          3017162,
          3059210,
          3006739,
          3006769,
          3027376,
          3097263,
          3017159,
          3006736,
          3006737,
          3006695,
          3006712,
          3006724,
          3006741,
          2989483,
          3006756,
          2989507,
          3027423,
          3006677,
          3008816,
          3008810,
          3014878,
          3008814,
          3008792,
          3014880,
          2985991,
          2985992,
          2985988,
          3087226,
          3087116,
          3010486,
          3010485,
          3010498,
          3010492,
          3010493,
          3010496,
          3007464,
          3006503,
          3010506,
          3016456,
          3016459,
          3025515,
          3025743,
          3027098,
          3027099,
          3027089,
          3027091,
          3027090,
          2989176,
          2989072,
          2989726,
          2989723,
          2989696,
          2989709,
          2919085,
          2919080,
          2918938,
          2918939,
          2924855,
          3005727,
          2984645,
          3002455,
          2984648,
          2984634,
          2984659,
          2984656,
          2938709,
          3038297,
          3038323,
          3068221,
          3024774,
          3003571,
          3002844,
          3011160,
          3024167,
          3024162,
          3024165,
          3019286,
          3019296,
          3019298,
          3030186,
          3030184,
          3030185,
          3012862,
          2933639,
          3011143,
          3017781,
          3010151,
          3011173,
          3019740,
          3019606,
          3019607,
          3011180,
          3047175,
          3047153,
          3025945,
          3025940,
          3035303,
          3024471,
          3035392,
          3028990,
          3029174,
          2985345,
          2985214,
          3024783,
          3024088,
          3024459,
          3024467,
          3035090,
          2951752,
          3088744,
          3028693,
          3088766,
          3035075,
          3035087,
          3026286,
          3026559,
          3090704,
          3022970,
          3022973,
          3088741,
          3090715,
          3008616,
          3095846,
          3095848,
          3093333,
          3093335,
          3088743,
          3029008,
          3029002,
          3090697,
          3024090,
          3024091,
          3069624,
          3007830,
          3007831,
          3007861,
          3007864,
          3007874,
          3007390,
          3007391,
          3007393,
          3007396,
          3007398,
          3007395,
          3007832,
          3034338,
          3034350,
          3034339,
          3004797,
          3009567,
          3004857,
          3009491,
          3009588,
          3038975,
          3007064,
          3000820,
          3025807,
          2973267,
          2973272,
          2996714,
          3013186,
          3013081,
          3013114,
          3013033,
          3013041,
          3009335,
          2996711,
          3022328,
          3022330,
          3022320,
          3022321,
          3022327,
          3022324,
          3022325,
          3022323,
          3001108,
          3001074,
          3025271,
          3000599,
          3054260,
          3028513,
          3037161,
          3010554,
          3010605,
          2979071,
          3004022,
          2979128,
          2979097,
          3020635,
          3020639,
          3020431,
          2998124,
          2998135,
          2998140,
          3005565,
          3005615,
          3005551,
          3005526,
          2998138,
          2998141,
          3005618,
          3007190,
          3004802,
          3007166,
          3005600,
          3005602,
          3005604,
          3024420,
          3024442,
          3024444,
          3016023,
          3012071,
          3012072,
          3034346,
          3034459,
          3028734,
          3028736,
          3006688,
          2989536,
          2989540,
          2990930,
          3013609,
          3013610,
          3013611,
          3008772,
          3008788,
          3008793,
          3010685,
          3010710,
          3010711,
          3025965,
          3027088,
          3025289,
          3027105,
          2988968,
          2988966,
          2988967,
          3047325,
          3047414,
          2988738,
          3017169,
          3019552,
          2989708,
          2988760,
          2987753,
          2989707,
          2980812,
          2980830,
          2980828,
          2988961,
          3003375,
          3007860,
          3061052,
          3038253,
          3009141,
          2979078,
          3013296,
          3013300,
          3027000,
          3028727,
          3028728,
          3011124,
          3006709,
          2989702,
          2988809,
          2988844,
          2988862,
          2981499,
          2982884,
          2981335,
          3032628,
          3003390,
          3028511,
          3076031,
          3013588,
          3030237,
          3019714,
          3019684,
          3019695,
          3003070,
          3002398,
          3002397,
          3004811,
          3022983,
          3022975,
          2940855,
          3007405,
          3007412
          }
